// ==========================================================================
// Dark Mode Theme
// ==========================================================================

// Import variables to use as CSS variable defaults
@use '../base/variables' as *;
@use '../base/mixins' as *;

// Dark mode
[data-theme="dark"] {
  // Use Sass variables directly for dark mode surfaces and text

  body {
    background: $dark-bg-primary !important;
    color: $dark-text-light !important;
  }

  // Header
  .header {
    color: $dark-text-light !important; // Light text for header
    background: transparent; // Remove any header background
    h1 {
      color: $dark-text-light !important; // Light text for header
    }
  }

  // Controls section
  .controls {
    background: $dark-bg-primary !important; // Dark background for dark mode
    padding: 0;
  }

  // Table container
  .table-container {
    background: $dark-bg-primary !important; // Dark background
    border: 1px solid $dark-border-dark !important; // Dark border
  }

  // Music table
  .music-table,
  #albumsTable {
    background: $dark-bg-primary !important; // Dark background
    color: $dark-text-light !important; // Light text

    thead {
      background: $dark-bg-primary !important; // Dark for header
    }

    th {
      color: $dark-text-light !important; // Light text for headers
      border-bottom: 1px solid $dark-border-dark !important; // Dark border

      &.sortable-header:hover {
        background-color: #141414 !important; // Dark gray on hover in dark mode
      }
    }

    td {
      color: $dark-text-light !important; // Light text for table cells
      border-bottom: 1px solid $dark-border-dark !important; // Dark border
    }

    tbody tr:hover {
      background: $dark-row-hover !important; // Row hover
    }
  }

  // Sort indicators
  .sort-asc,
  .sort-desc {
    .sort-indicator::after {
      color: $dark-text-light !important; // Light sort indicators in dark mode
    }
  }

  // Artist and album name text
  .artist-name,
  .album-name,
  .album-year {
    color: $dark-text-light !important; // Light text for artist and album names

    a {
      color: $dark-text-light !important; // Light text for artist and album links
    }
  }

  // Cover modal album year styling with proper nesting
  .cover-modal-content {
    .cover-modal-info {
      .album-year {
      color: $dark-text-light !important; // Light text for album year in cover modal dark mode
      }
    }
  }

  .cover-modal-info {
    .album-year {
      color: $dark-text-light !important; // Use Sass variable for light text
    }
  }

  #coverModalInfo {
    .album-year {
      color: $dark-text-light !important; // Force light text using ID selector
    }

    > div.album-year {
        color: $dark-text-light !important; // Light text for album year in dark mode
    }
  }

  #coverModal {
    #coverModalInfo {
      > div.album-year {
        color: #ffffff !important; // White text for album year in dark mode
      }
    }
  }

  // Buttons
  .btn-primary {
    background: $primary-color;
    border-color: $primary-color;
    color: $text-light;
  }

  #tracklistModal {
    .tracklist-modal-actions {
      .btn-primary {
        background: transparent;
        border-color: transparent;
      }
    }
  }

  .btn-secondary {
    background: $dark-bg-secondary;
    border-color: $dark-border-color;
    color: $dark-text-primary;
  }

  // Dropdown
  .dropdown-menu {
    background: $dark-menu-bg !important; // Dark gray background
    border: 1px solid $dark-border-dark !important; // Dark border
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5) !important; // Dark shadow

    .dropdown-item {
      color: $dark-text-light !important; // Light text
      
      &:hover {
        background: $dark-bg-secondary !important; // Secondary bg on hover
      }
    }
  }

  // Modals
  .modal-content {
    background: $dark-menu-bg !important; // Dark gray background
    color: $text-light !important; // Light text
    border: 1px solid $border-dark !important; // Dark border

    // Modal headers and titles
    h1, h2, h3, h4, h5, h6 {
    color: $dark-text-light !important; // Light text for all modal headings
    }

    // Modal labels
    label {
      color: $dark-text-light !important; // Light text for modal labels
    }

    // Modal paragraphs and text
    p {
      color: $dark-text-light !important; // Light text for modal paragraphs
    }

    // Modal lists
    ul, ol {
      color: $dark-text-light !important; // Light text for modal lists
    }

    // Modal list items
    li {
      color: $dark-text-light !important; // Light text for modal list items
      
      a {
        color: $dark-text-light !important; // Light text for modal list items
        text-decoration: underline;
        
        &:hover {
          text-decoration: none;
        }
      }
    }

    // Modal close buttons
    .close {
      color: $dark-text-light !important; // Light close button
      
      &:hover {
        background-color: $dark-border-color !important; // Medium gray hover background for better contrast
        color: $dark-text-light !important; // Keep light text on hover
      }
    }
  }

  // Edit warning
  .edit-warning {
    background: $dark-bluegray-bg !important; // Dark blue-gray background
    color: $dark-text-light !important; // Light text
    border: 1px solid $dark-border-light !important; // Darker border

    strong {
      color: $dark-text-light !important; // Light text for strong elements
    }
  }

  // Form elements
  input, select, textarea {
    background: $bg-primary !important; // Light background
    border: 1px solid $dark-border-dark !important; // Dark border
    color: $text-dark !important; // Dark text

    &:focus {
      border-color: #667eea !important; // Blue border on focus
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.3) !important; // Blue glow
    }
  }

  // Status badges
  .status-owned {
    background: $dark-bg-secondary !important; // Dark background like edit/delete buttons
    color: $dark-text-light !important; // Light text
    border: 1px solid $dark-border-dark !important; // Dark border

    .checkmark {
      color: $dark-text-light !important; // Light checkmarks for owned status
    }
  }

  .status-wanted {
    background: $dark-bg-secondary !important; // Dark background like edit/delete buttons
    color: $dark-text-light !important; // Light text
    border: 1px solid $dark-border-dark !important; // Dark border

    .checkmark {
      color: $dark-text-light !important; // Light checkmarks for wanted status
    }
  }

  .status-none {
    background: $bg-secondary;
    color: $text-muted;
  }

  // Status checkmarks and icons
  .checkmark {
    color: $dark-text-light !important; // Light checkmarks in dark mode
  }

  // Mobile status badges in dark mode
  @media (max-width: 768px) {
    .status-owned,
    .status-wanted {
      background: #2d2d2d !important;
      border-radius: 4px;
      padding: 6px 0;
      width: 60px !important; // Match album art width on mobile
      text-align: center;
      line-height: .9;
    }
  }

  // Year badges
  .year-badge {
    background: $dark-bg-secondary !important; // Secondary background
    color: $dark-text-light !important; // Light text
    border: 1px solid $dark-border-dark !important; // Dark border
  }

  // Edit and delete buttons
  .btn-edit,
  .btn-delete {
    background: $dark-bg-secondary !important; // Secondary background
    color: $dark-text-light !important; // Light text
    border: 1px solid $dark-border-dark !important; // Dark border

    &:hover {
      background: $dark-border-color !important; // Slightly lighter gray on hover
      color: $dark-text-light !important; // Keep light text on hover
    }
  }

  // Filter buttons
  .filter-btn {
    background: $dark-bg-secondary !important; // Secondary background
    color: $dark-text-light !important; // Light text
    border: 1px solid $dark-border-dark !important; // Dark border

    &:hover {
      background: $dark-border-color !important; // Slightly lighter gray on hover
      color: $dark-text-light !important; // Keep light text on hover
    }

    &.active {
      background: $dark-accent !important; // Primary theme color for active state
      color: $dark-text-light !important; // Light text for active state
    }
  }

  // Add button
  .add-btn {
    background: #2F855A !important; // Bright vibrant green
    color: #ffffff !important; // White text
    border: 1px solid #246645 !important; // Slightly darker green border

    &:hover {
      background: #246645 !important; // Darker green on hover
      color: #ffffff !important; // Keep white text on hover
    }
  }

  // Info sections
  .warning,
  .password-requirements,
  .setup-instructions,
  .setup-status,
  .theme-note,
  .demo-note {
    background: $dark-bluegray-bg !important; // Dark blue-gray background
    color: #ffffff !important; // White text
    border-left: 4px solid $dark-bluegray-border !important; // Darker border
    border-radius: 4px;
  }

  // Status labels
  .status-label {
    color: #ffffff !important; // White text in dark mode
  }

  // Format stat items
  .format-stat-item,
  .label-stat-item {
    background: $dark-bluegray-bg !important; // Dark blue-gray background
    color: #ffffff !important; // White text

    &:hover {
      background: $dark-bluegray-border !important; // Slightly lighter gray on hover
      color: #ffffff !important; // Keep white text on hover
    }

    .format-name,
    .label-name {
      color: #ffffff !important; // White text for format names
    }
  }

  // Style stat items
  .style-stat-item {
    background: $dark-bluegray-bg !important; // Dark blue-gray background
    color: #ffffff !important; // White text

    &:hover {
      background: $dark-bluegray-border !important; // Slightly lighter gray on hover
      color: #ffffff !important; // Keep white text on hover
    }

    .style-name {
      color: #ffffff !important; // White text for style names
    }
  }

  // Year stat items
  .year-stat-item {
    background: $dark-bluegray-bg !important; // Dark blue-gray background
    color: #ffffff !important; // White text

    &:hover {
      background: $dark-bluegray-border !important; // Slightly lighter gray on hover
      color: #ffffff !important; // Keep white text on hover
    }

    .year-name {
      color: #ffffff !important; // White text for year names
    }
  }

  // Stats containers
  .style-stats-container,
  .year-stats-container,
  .format-stats-container,
  .label-stats-container {
    border: 1px solid #333333 !important; // Dark border in dark mode
  }

  // Autocomplete
  .autocomplete-list {
    background: $dark-menu-bg !important; // Dark gray background
    border: 1px solid #333333 !important; // Dark border
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5) !important; // Dark shadow

    .autocomplete-item {
      color: #000000 !important; // Dark text by default
      
      &:hover {
        background: #2d2d2d !important; // Lighter gray on hover
        color: #ffffff !important; // White text on hover
      }
    }
  }

  // Loading states
  .loading {
    background: #000000 !important; // Pure black background
  }

  // Message boxes
  .message {
    background: #000000 !important; // Pure black background
    color: #ffffff !important; // White text
    border: none !important; // Remove border
    border-top: none !important; // Remove top border

    // Success messages - keep green colors
    &.success {
      background-color: $success-message !important; // Light green background
      color: #155724 !important; // Dark green text
      border: 1px solid $success-message-dark !important; // Light green border
      border-top: none !important; // Remove top border
    }

    // Error messages - keep red colors
    &.error {
      background-color: #f8d7da !important; // Light red background
      color: #721c24 !important; // Dark red text
      border: 1px solid #f5c6cb !important; // Light red border
      border-top: none !important; // Remove top border
    }

    // Info messages - keep blue colors
    &.info {
      background-color: #d1ecf1 !important; // Light blue background
      color: #0c5460 !important; // Dark blue text
      border: 1px solid #bee5eb !important; // Light blue border
      border-top: none !important; // Remove top border
    }
  }

  // Chart text colors (for Chart.js)
  .chart-text {
    color: $text-primary !important;
  }

  // Rating text colors
  .rating-value {
    color: #ffffff !important; // White text for rating values in dark mode
  }

  .rating-count {
    color: #b0b0b0 !important; // Light gray text for rating counts in dark mode
    
    a {
      color: #ffffff !important; // White text for rating count links in dark mode
    }
  }

  // Tracklist modal text colors
  .tracklist-modal-header {
    h3 {
      color: #ffffff !important; // White text for tracklist modal header in dark mode
    }
  }

  .tracklist-modal-info {
    color: #b0b0b0 !important; // Light gray text for tracklist modal info in dark mode
  }

  // Track list text colors
  .track-position {
    color: #ffffff !important; // White text for track positions in dark mode
  }

  .track-title {
    color: #ffffff !important; // White text for track titles in dark mode
  }

  // Side header styling in dark mode
  .track-item-side-header {
    .track-title {
      color: #ffffff !important; // White text for side header titles
    }
  }

  .track-duration,
  .lyrics-btn {
    color: #b0b0b0 !important; // Light gray text for track durations in dark mode
  }
  .lyrics-btn {
    &:hover {
      background-color: #ffffff !important;
      color: #000000 !important;
    }
  }
  
  .lyrics-btn-direct {
    background: $dark-neutral-2a !important;
    border-color: $dark-neutral-55 !important;
    color: #ffffff !important;
    opacity: 1 !important;
    z-index: 1000 !important;
    
    &:hover {
      background-color: $dark-border-color !important;
      color: #ffffff !important;
      text-decoration: none !important;
    }
  }
  
  // Lyrics dropdown dark mode styles - aggressive approach
  .lyrics-links {
    z-index: 1000 !important;
    
    .lyrics-dropdown {
      z-index: 1000 !important;
      
      .lyrics-btn {
        background: $dark-neutral-2a !important;
        border-color: $dark-neutral-55 !important;
        color: #ffffff !important;
        opacity: 1 !important;
        z-index: 1000 !important;
        
        &:hover {
          background-color: $dark-border-color !important;
          color: #ffffff !important;
        }
      }
      
      .lyrics-menu {
        background-color: $dark-neutral-2a !important;
        border-color: $dark-neutral-55 !important;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6) !important;
        z-index: 999999 !important;
        opacity: 1 !important;
        
        a {
          color: #ffffff !important;
          background-color: $dark-neutral-2a !important;
          opacity: 1 !important;
          z-index: 1000000 !important;
          
          &:hover {
            background-color: $dark-border-color !important;
            color: #ffffff !important;
          }
        }
      }
    }
  }
  
  .lyrics-indicator {
    opacity: 1 !important;
  }
  
  // Ensure artist-website-section stays below lyrics dropdown in dark mode
  .artist-website-section {
    z-index: 1 !important;
    
    .artist-website-links {
      z-index: 1 !important;
      
      .artist-website-link {
        z-index: 1 !important;
      }
    }
  }

  // Tracklist loading text
  .tracklist-loading {
    color: #ffffff !important; // White text for tracklist loading in dark mode
  }

  #tracklistModalInfo {
    div {
      a {
        color: #ffffff !important;
      }
    }
  }

  .album-link,
  .artist-link {
    &:focus {
      outline: 2px solid $demo-accent;
    }
    &:hover {
      background: none;
    }
  }

  // Setup page dark mode styles
  .setup-page {
    background: #000000 !important; // Pure black background for dark mode
  }

  .setup-container {
    background: #000000 !important; // Dark gray background
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }

  .setup-header {
    background: #000000;
    color: #ffffff !important;
  }

  .setup-header-content {
    h1 {
      color: #ffffff !important;
    }
    
    p {
      color: #ffffff !important;
    }
  }

  .setup-nav .btn-back {
    background: #D2199A !important;
    color: #ffffff !important;
    border-color: #333333 !important;
    padding: $spacing-md;
    
    &:hover {
      background: rgba(255, 255, 255, 0.2);
    }
  }

  .setup-main {
    background: #000 !important;
    border: 1px solid #333 !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, .1);
  }

  .setup-section {
    h2 {
      color: #ffffff !important;
    }
    
    p {
      color: #ffffff !important;
    }
  }

  .setup-instructions {
    background: #2d2d2d !important;
    border-color: $dark-border-color !important;
    
    h3 {
      color: #ffffff !important;
    }
    
    ol li {
      color: #ffffff !important;
      
      a {
        color: #667eea !important;
      }
    }
  }

  .setup-status .status-item {
    background: #2d2d2d !important;
    border-color: $dark-border-color !important;
    
    .status-label {
      color: #ffffff !important;
    }
  }

  .form-group {
    label {
      color: #ffffff !important;
    }
    
    input[type="text"] {
      background: #ffffff !important;
      border-color: $dark-border-color !important;
      color: #000000 !important;
    }
  }

  .setup-message {
    &.success {
      background: #d4edda !important;
      color: #155724 !important;
      border-color: #c3e6cb !important;
    }
    
    &.error {
      background: #f8d7da !important;
      color: #721c24 !important;
      border-color: #f5c6cb !important;
    }
  }

  .current-value {
    background: #2d2d2d !important;
    border: 1px solid $border-color;
    border-color: $dark-border-color !important;
    border-radius: $border-radius-md;
    padding: $spacing-md;
    margin-bottom: $spacing-sm;
    font-size: 0.9rem;
    
    strong {
      color: $text-light;
    }
  }

  .radio-option {
    .radio-label {
      color: #ffffff !important;
    }
  }

  .theme-note {
    background: $dark-bluegray-bg !important;
    border-color: $dark-bluegray-border !important;
    color: #ffffff !important;
  }

  .color-picker-item {
    label {
      color: #ffffff !important;
    }
    
    input[type="text"] {
      background: #ffffff !important;
      border-color: $dark-border-color !important;
      color: #000000 !important;
    }
  }

  .btn-save {
    background: $success-color !important; // Use Sass variable directly
    color: #ffffff !important;
  }

  .btn-secondary {
    background: #2d2d2d !important;
    color: #ffffff !important;
    border-color: $dark-border-color !important;
    
    &:hover {
      background: #3a3a3a !important;
    }
  }

  // Tab styling for dark mode
  .tab-button {
    background: #2d2d2d !important;
    border-color: $dark-border-color !important;
    color: #ffffff !important;
    
    &:hover {
      background: #3a3a3a !important;
      border-color: $primary-color !important;
      color: $primary-color !important;
    }
    
    &.active {
      background: $primary-color !important;
      border-color: $primary-color !important;
      color: #ffffff !important;
      
      &:hover {
        background: $primary-dark !important;
        border-color: $primary-dark !important;
      }
    }
  }

  // Settings tab styling for dark mode
  .settings-group {
    h3 {
      color: #ffffff !important;
      border-color: $dark-border-color !important;
    }
    
    .settings-description {
      color: #b0b0b0 !important;
    }
  }

  .artist-links-controls,
  .stats-controls,
  .album-info-controls {
    .btn-select-all,
    .btn-select-none {
      background: #2d2d2d !important;
    border-color: $dark-border-color !important;
      color: #ffffff !important;
      
      &:hover {
        background: $primary-color !important;
        color: #ffffff !important;
        border-color: $primary-color !important;
      }
    }
  }

  .toggle-group {
    h4 {
      color: #ffffff !important;
    }
    
    .toggle-option {
      &:hover {
        background: rgba($primary-color, 0.1) !important;
      }
    }
    
    .toggle-label {
      color: #ffffff !important;
    }
    
    .toggle-switch {
      .toggle-slider {
        background-color: $dark-neutral-55 !important;
        
        &:before {
          background-color: #ffffff !important;
        }
      }
      
      input[type="checkbox"]:checked + .toggle-slider {
        background-color: $primary-color !important;
      }
      
      input[type="checkbox"]:focus + .toggle-slider {
        box-shadow: 0 0 0 2px rgba($primary-color, 0.3) !important;
      }
    }
  }

  .checkbox-option {
    &:hover {
      .checkbox-label {
        color: $primary-color !important;
      }
    }
    
    .checkbox-label {
      color: #ffffff !important;
    }
    
    input[type="checkbox"] {
      accent-color:#FFFFFF;
    }
    
    input[type="checkbox"]:checked + .checkbox-label {
      color: #ffffff !important;
      font-weight: 600;
    }
  }

  // Demo reset section dark mode
  .demo-reset {
    border-color: $demo-warning;
    background: rgba($demo-warning, 0.1);
    
    h2, p {
      color: $demo-warning;
    }
  }

  // Display mode group dark mode styles
  .display-mode-group {
    .radio-option {
      background-color: #2d2d2d !important;
      border-color: #4a4a4a !important;
      
      &:hover {
        border-color: #667eea !important;
        background-color: #3a3a3a !important;
      }
      
      &.checked {
        border-color: #667eea !important;
        background-color: #3a3a3a !important;
      }
    }
    
    .radio-label {
      color: #e0e0e0;
    }
    
    input[type="radio"]:checked + .radio-label {
      color: #667eea;
    }
  }

  // Dark mode styles for artist website section
  .artist-website-section {
    border-top-color: $border-light;
  }

  .artist-website-header {
    color: $text-light !important;
  }

  .artist-website-link {
    background: $primary-dark;
    
    &:hover {
      background: $primary-color;
    }
    
    &.discogs-link {
      background: #6a3d8a; // Darker version of $secondary-color
      
      &:hover {
        background: $secondary-color;
      }
    }
  }

  // Dark Mode Styles for All Modals
  #welcomeModal {
    .welcome-info p {
      color: #e2e8f0;
    }
    
    .demo-features {
      h3 {
        color: #e2e8f0;
        border-bottom-color: $dark-bluegray-border;
      }
      
      ul li {
        color: #a0aec0;
        
        strong {
          color: #e2e8f0;
        }
      }
      
      code {
        background: $dark-bluegray-border;
        color: #f8f700;
      }
    }
    
    .demo-note {
      p {
        color: #f8f700 !important;
        font-size: 1.2rem;
        font-style: italic;
      }
    }
    
    .btn-primary {
      background-color: #e83db4;
      border-color: #e83db4;
      
      &:hover {
        background-color: #d42a9f;
        border-color: #c0258a;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      
      &:active {
        transform: translateY(0);
      }
    }
  }

  #demoResetSuccessModal {
    .success-info {
      background: transparent;
      border-color: transparent;
      
      p {
        color: #e2e8f0;
      }
      
      ul li {
        color: #a0aec0;
      }
      
      code {
        background: rgba(0,0,0,.5);
        color: $demo-highlight;
      }
      
      .info {
        color: $demo-highlight !important;
        font-size: 1.25rem !important;
        font-style: italic !important;
        margin-top: 1.5rem !important;
        background-color: rgba(0,0,0,.5) !important;
        padding: 20px;
        border-radius: 5px;
        border-left: 4px solid $dark-bluegray-border !important;
      }
    }
    
    .btn-primary {
      background-color: $demo-accent;
      border-color: $demo-accent;
      
      &:hover {
        background-color: $demo-accent-hover;
        border-color: $demo-accent-border;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      
      &:active {
        transform: translateY(0);
      }
    }
  }

  #resetDemoModal {
    .reset-info {
      background: transparent;
      border-color: transparent;
      
      p {
        color: #e2e8f0;
      }
      
      ul li {
        color: #a0aec0;
      }
      
      code {
        background: rgba(0,0,0,.5);
        color: #f8f700;
      }
    }
    
  .warning {
    color: $demo-highlight !important;
      font-size: 1.25rem !important;
      font-style: italic !important;
      margin-top: 1.5rem !important;
      background-color: rgba(0,0,0,.5) !important;
    }
    
  .btn-danger {
    background-color: $demo-accent;
    border-color: $demo-accent;
      
      &:hover {
      background-color: $demo-accent-hover;
      border-color: $demo-accent-border;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      
      &:active {
        transform: translateY(0);
      }
    }
  }

  #deleteConfirmationModal {
    .btn-danger {
      @include button-base;
      background-color: $demo-accent;
      border-color: $demo-accent;
      color: $dark-text-light;
      
      &:hover {
        background-color: $demo-accent-hover;
      }
      
      &:active {
        transform: translateY(0);
      }
    }
    
    .album-info {
      background: $dark-bluegray-bg;
      border-color: $dark-bluegray-border;
      
      strong {
        color: $dark-text-light;
      }
      
      .year {
        color: $dark-text-light !important;
      }
    }
    
    .warning {
      color: $demo-highlight !important;
    }
  }
}

// Smooth transitions for theme changes
* {
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}
